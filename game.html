<html>
<!-- https://opengameart.org/content/classic-knight-animated -->
<!-- img src="./Old-hero-Edit.gif" id="ss" -->
<img src="data:image/gif;base64,R0lGODlhgAAeAfcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAgEBBQLCxgNDRgNDRgNDRgNDRgNDRgNDRgNDRgNDRgNDRkODhkODhkODhkODhkODhkODhkODhkODhkODhkODhkODhkODhkODh8UFC0iIjctLT81NUU6Okc9PUc9PUc9PUc9PUc+Pkg+Pkg+Pkg+Pkg+Pkg+PkhAQEhDQ0hGRkhHR0hISEhISElISElJSE1LR1RRRWJaQXdqO5R/M7SWKs6qIui9G/TGGPvLFv3NFf7NFf7NFf7NFf7NFf7NFf7NFf7NFf7NFf7KF/3GG/y/Ifu4J/quMfmnN/ijPPefQfabRvWZSfSZTPOYT/KXVfCWWu+UXO+RWu+KVu6CUu17T+1ySexmQexYOOtPMetGK+tEKutEKutEKutEKutEKutEKutEKutEKutEKutEKupEKupEKupEKupEKupEKupEKudHLtlSPbZtYpuDf5GLio6NjY6NjY6NjY6NjY6NjY6NjY6NjY6NjY6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo+OjpORj6Wck76rmdi7n+3Io/jPpvzSp/7Tp/7Tp/7Tp/7Tp/7Tp/7Tp/7TqP7TqP7UqP7UqP7UqP7UqP7UqP7UqP7UqP7UqPvUq/fUsPHVuOrWwOXWx+DXzdzX0trX1djX1tjX19jX19jX19jX19fX19fX2NfX2NfX2NXW2dPV2s/S3MrP38TL4r3H5rXC6rC+7qy88Kq68am68am68am68am68am68aq68qu88q6+8rHA87TD87nH9L/M9dbe+Oru+/j6/v7+/v7+/v7+/v7+/v7+/v///////////////////////////////////////////////////////////////////////////////v///v///v///v///P//9f//8f//7v//7P//6///6///6///6///6///6///6///6///6///6///6///6///6///6///6///6yH5BAkAAOYAIf47R2VuZXJhdGVkIGJ5IGpzZ2lmIChodHRwczovL2dpdGh1Yi5jb20vYW50aW1hdHRlcjE1L2pzZ2lmLykALAAAAACAAB4BAAj+AM0JHEiwoMGDCBMqXMiwocOHECNKnEixosWLGDNq3Mixo8eP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" id="ss" />


<canvas id="c" width="800" height="600"></canvas>

<script>
var c; // canvas
var cc; // canvasContext
var ss; // spritesheet
var px = 100; // player x
var py = 100; // player y
var pdx = 0; // player delta x
var pdy = 0; // player delta y
var ps = 1; // player speed
var sword = false;
// subimageX, subImagey, subImageWidth, subImageHeight  
var sm = [ // sprite map
{sx: 12, sy: 5, sw: 20, sh: 20, dw: 100, dh: 100}, // normal
{sx: 12, sy: 25, sw: 20, sh: 20, dw: 100, dh: 100}, // normal 2
{sx: 57, sy: 97, sw: 40, sh: 20, dw: 200, dh: 100},  // sword
{sx: 30, sy: 240, sw: 40, sh: 20, dw: -200, dh: 100},  // sword left
{sx: 96, sy: 147, sw: 20, sh: 20, dw: 100, dh: 100}, // normal left
{sx: 96, sy: 169, sw: 20, sh: 20, dw: 100, dh: 100}, // normal 2 left
];
var leftFacing = false;
var animationSM = [sm[0], sm[1]];
var animationLeftSM = [sm[4], sm[5]];
var currentSprite = sm[0]; //current sprite
var bucket = 0;
var threshold = 50;

window.onload = function() {
	c = document.getElementById('c');
	cc = c.getContext('2d');
	ss = document.getElementById('ss');
	setInterval(draw, 1);
	console.log("width:" + ss.width + " and height: " + ss.height);
}

document.addEventListener('keydown', (event) => {
	const keyCode = event.keyCode;
	switch (keyCode) {
		case 32: sword = true; break;
		case 37: pdx = -1; leftFacing = true; break;
		case 38: pdy = -1;break;
		case 39: pdx = 1; leftFacing = false; break;
		case 40: pdy = 1;break;
		default:break;
	}
}, false);

document.addEventListener('keyup', (event) => {
        const keyCode = event.keyCode;
        switch (keyCode) {
		case 32: sword = false; break;
                case 37: pdx = 0;break;
                case 38: pdy = 0;break;
                case 39: pdx = 0; break;
                case 40: pdy = 0; break;
                default:break;
        }
}, false);

function update() {
        px = px + pdx * ps;
        py = py + pdy * ps;
	if (sword) {
		currentSprite = leftFacing ? sm[3] : sm[2];
	} else if (pdx !== 0 || pdy !== 0) {
		if (bucket < threshold) {
			bucket++;
		} else {
		  const animationThing = leftFacing ? animationLeftSM : animationSM;
			var i = animationThing.indexOf(currentSprite);
			console.log(i);
			if (i < 0 || i + 1 >= animationThing.length) {
				i = 0;
			} else {
				i++;
			}
			currentSprite = animationThing[i];
			bucket = 0;
		}
	} else {
		currentSprite = leftFacing ? sm[4] : sm[0];
	}

}

function draw() {
	this.update();
        // background
	cc.fillStyle = 'black';
    cc.fillRect(0,0,c.width,c.height);

	// draw below
	cc.drawImage(ss, currentSprite.sx, currentSprite.sy, currentSprite.sw, currentSprite.sh, px, py, currentSprite.dw, currentSprite.dh);
}

</script>

</html>
